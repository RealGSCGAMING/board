<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generic Board Game</title>
    <style>
        body {
            display: flex;
            overflow: hidden;
            height: 100vh;
            margin: 0;
        }
        #left-panel {
            width: 25%;
            padding: 20px;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #roll-button {
            margin: 20px 0;
            padding: 15px;
            font-size: 18px;
            cursor: pointer;
        }
        #roll-result {
            font-size: 22px;
            margin-top: 15px;
        }
        #board-container {
            overflow: hidden;
            flex: 1;
            background-color: green;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #board {
            display: grid;
            grid-template-columns: repeat(50, 30px);
            grid-template-rows: repeat(50, 30px);
            transition: transform 0.5s ease;
        }
        .space {
            width: 30px;
            height: 30px;
        }
        .moveable {
            background-color: white;
            border: 1px solid black;
        }
        .background {
            background-color: green;
        }
        .player {
            background-color: red;
        }
    </style>
</head>
<body>
    <div id="left-panel">
        <h2>Generic Board Game (WIP)</h2>
        <button id="roll-button">Roll Die</button>
        <div id="roll-result"></div>
    </div>
    <div id="board-container">
        <div id="board"></div>
    </div>

    <script>
        const boardSize = 50;
        let currentPosition = 0;
        let spaces = [];
        let path = [];
        let rolling = false;

        const rollButton = document.getElementById('roll-button');
        const rollResult = document.getElementById('roll-result');
        const board = document.getElementById('board');

        function generateBoard() {
            // Create an empty grid
            for (let i = 0; i < boardSize * boardSize; i++) {
                let spaceDiv = document.createElement('div');
                spaceDiv.classList.add('space');
                spaceDiv.classList.add('background');
                board.appendChild(spaceDiv);
                spaces.push(spaceDiv);
            }

            // Initialize the path and moveable spaces
            path = [];
            let visited = new Set();
            let startRow = Math.floor(Math.random() * boardSize);
            let startCol = Math.floor(Math.random() * boardSize);
            let currentRow = startRow;
            let currentCol = startCol;

            path.push({row: currentRow, col: currentCol});
            visited.add(`${currentRow},${currentCol}`);

            // Generate path ensuring only two adjacent moveable spaces
            function isValidMove(row, col) {
                let count = 0;
                if (visited.has(`${row - 1},${col}`)) count++;
                if (visited.has(`${row + 1},${col}`)) count++;
                if (visited.has(`${row},${col - 1}`)) count++;
                if (visited.has(`${row},${col + 1}`)) count++;
                return count === 1;
            }

            while (path.length < boardSize * boardSize / 2) {
                let directions = [
                    { row: currentRow - 1, col: currentCol }, // Up
                    { row: currentRow + 1, col: currentCol }, // Down
                    { row: currentRow, col: currentCol - 1 }, // Left
                    { row: currentRow, col: currentCol + 1 }  // Right
                ].filter(dir => dir.row >= 0 && dir.row < boardSize && dir.col >= 0 && dir.col < boardSize);

                directions = directions.filter(dir => !visited.has(`${dir.row},${dir.col}`) && isValidMove(dir.row, dir.col));

                if (directions.length > 0) {
                    let next = directions[Math.floor(Math.random() * directions.length)];
                    currentRow = next.row;
                    currentCol = next.col;
                    path.push({row: currentRow, col: currentCol});
                    visited.add(`${currentRow},${currentCol}`);
                } else {
                    break;
                }
            }

            // Mark moveable spaces and player position
            path.forEach(pos => {
                let index = pos.row * boardSize + pos.col;
                spaces[index].classList.remove('background');
                spaces[index].classList.add('moveable');
            });
            spaces[path[0].row * boardSize + path[0].col].classList.add('player');

            centerPlayer();
        }

        function rollDie() {
            if (rolling) return;
            rolling = true;
            rollButton.disabled = true;
            rollButton.style.backgroundColor = "grey";
            let roll = Math.floor(Math.random() * 6) + 1;
            rollResult.textContent = roll;

            movePlayer(roll);
        }

        function movePlayer(roll) {
            let steps = 0;

            let moveInterval = setInterval(() => {
                // Remove player from current position
                spaces[path[currentPosition].row * boardSize + path[currentPosition].col].classList.remove('player');

                // Move to next position
                currentPosition++;
                if (currentPosition >= path.length) {
                    currentPosition = path.length - 1;
                }

                // Place player at new position
                spaces[path[currentPosition].row * boardSize + path[currentPosition].col].classList.add('player');
                steps++;

                // Stop moving after rolling steps
                if (steps >= roll) {
                    clearInterval(moveInterval);
                    centerPlayer();
                }
            }, 300);
        }

        function centerPlayer() {
            let playerSpace = spaces[path[currentPosition].row * boardSize + path[currentPosition].col];
            let rect = playerSpace.getBoundingClientRect();
            let boardRect = board.getBoundingClientRect();
            let offsetX = boardRect.left - rect.left + (boardRect.width / 2) - (rect.width / 2);
            let offsetY = boardRect.top - rect.top + (boardRect.height / 2) - (rect.height / 2);

            board.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
            
            setTimeout(() => {
                rolling = false;
                rollButton.disabled = false;
                rollButton.style.backgroundColor = "";
            }, 600);
        }

        window.onload = function() {
            generateBoard();
            centerPlayer(); // Center on player when page loads
        };

        rollButton.addEventListener('click', rollDie);
    </script>
</body>
</html>
